{"version":3,"file":"commonHelpers.js","sources":["../src/api.js","../src/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst PIXABAY_API_KEY = '29782836-0cb6e5c5167e525a8102df66c';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nasync function fetchPhotosByQuery(query, page) {\n  const url = `?key=${PIXABAY_API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=40\n  `;\n\n  const { data } = await axios.get(url);\n  return data;\n}\n\nexport { fetchPhotosByQuery };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchPhotosByQuery } from './api';\n\nconst searchFormEl = document.querySelector('form#search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst textLoader = document.querySelector('.loader');\nconst textError = document.querySelector('.error');\nconst loadMoreButton = document.querySelector('.load-more');\n\nvar lightbox;\n\nlet query = '';\nlet page = 1;\nlet differenceFromTotalAmount = 0;\n\nsearchFormEl.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click' || 'keydown', handleButtonLoadMore);\n\nasync function getPhotoByQuery(query, page) {\n  try {\n    const result = await fetchPhotosByQuery(query, page);\n    return result;\n  } catch (error) {\n    console.log(error);\n    textError.classList.remove('hidden');\n  } finally {\n    textLoader.classList.add('hidden');\n  }\n}\n\nasync function handleSubmit(evt) {\n  evt.preventDefault();\n  const form = evt.target;\n  query = form.elements.searchQuery.value.trim();\n\n  if (query === '') {\n    iziToast.info({\n      theme: 'green',\n      position: 'topRight',\n      message: `Input field couldn't be empty. Please, enter search name.`,\n    });\n    return;\n  }\n  loadMoreButton.classList.add('hidden');\n  textError.classList.add('hidden');\n  textLoader.classList.remove('hidden');\n\n  galleryEl.innerHTML = '';\n  page = 1;\n\n  try {\n    const photosData = await getPhotoByQuery(query, page);\n\n    const { hits, totalHits } = photosData;\n\n    differenceFromTotalAmount = totalHits - hits.length;\n\n    if (hits.length < 1) {\n      iziToast.error({\n        theme: 'red',\n        position: 'topRight',\n        message: `Sorry, there are no images matching your search query. Please try again.`,\n      });\n      return;\n    }\n\n    if (differenceFromTotalAmount > 0) {\n      loadMoreButton.classList.remove('hidden');\n    }\n\n    iziToast.success({\n      theme: 'green',\n      position: 'topRight',\n      message: `Hooray! We found ${totalHits} images.`,\n    });\n\n    photosData.hits\n      .map(photo => {\n        const markup = createMarkup(photo);\n        galleryEl.insertAdjacentHTML('beforeend', markup);\n      })\n      .join('');\n\n    lightbox = new SimpleLightbox('.gallery a', {\n      /* options */\n      captions: true,\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n    searchFormEl.reset();\n  } catch (error) {\n    console.log(error);\n    textError.classList.remove('hidden');\n  }\n}\n\nasync function handleButtonLoadMore(evt) {\n  evt.preventDefault();\n  textError.classList.add('hidden');\n  textLoader.classList.remove('hidden');\n  page += 1;\n\n  try {\n    const photosData = await getPhotoByQuery(query, page);\n    const { hits } = photosData;\n\n    differenceFromTotalAmount -= hits.length;\n\n    if (differenceFromTotalAmount <= 0) {\n      iziToast.info({\n        theme: 'green',\n        position: 'topRight',\n        message: `We're sorry, but you've reached the end of search results.`,\n      });\n      loadMoreButton.classList.add('hidden');\n    }\n\n    photosData.hits\n      .map(photo => {\n        const markup = createMarkup(photo);\n        galleryEl.insertAdjacentHTML('beforeend', markup);\n      })\n      .join('');\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n    textError.classList.remove('hidden');\n  }\n}\n\nfunction createMarkup(photo) {\n  const {\n    largeImageURL,\n    webformatURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = photo;\n  const markup = `\n      <div class=\"photo-card\">\n        <a class=\"photo-link\" href=\"${largeImageURL}\">\n          <div class=\"photo-content-wrapper\">\n            <div photo-image-wrapper>\n              <img\n                class=\"photo-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n                title=\"${tags}\"\n                loading=\"lazy\"\n              />\n            </div>\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                <br />\n                ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                <br />\n                ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                <br />\n                ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                <br />\n                ${downloads}\n              </p>\n            </div>\n          </div>\n        </a>\n      </div>\n`;\n\n  return markup;\n}\n"],"names":["PIXABAY_API_KEY","axios","fetchPhotosByQuery","query","page","url","data","searchFormEl","galleryEl","textLoader","textError","loadMoreButton","lightbox","differenceFromTotalAmount","handleSubmit","handleButtonLoadMore","getPhotoByQuery","error","evt","iziToast","photosData","hits","totalHits","photo","markup","createMarkup","SimpleLightbox","largeImageURL","webformatURL","tags","likes","views","comments","downloads"],"mappings":"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"}